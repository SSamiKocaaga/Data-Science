<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=OPeqXG-QxW3ZD8BtmPikfA');.lst-kix_7g4otyu426l0-0>li:before{content:"\0025cf  "}.lst-kix_7g4otyu426l0-1>li:before{content:"\0025cb  "}.lst-kix_7g4otyu426l0-2>li:before{content:"\0025a0  "}ul.lst-kix_7eyu3rfxxwjr-7{list-style-type:none}.lst-kix_7eyu3rfxxwjr-8>li:before{content:"\0025a0  "}ul.lst-kix_7eyu3rfxxwjr-8{list-style-type:none}.lst-kix_7g4otyu426l0-7>li:before{content:"\0025cb  "}.lst-kix_7eyu3rfxxwjr-5>li:before{content:"\0025a0  "}.lst-kix_7g4otyu426l0-6>li:before{content:"\0025cf  "}.lst-kix_7g4otyu426l0-4>li:before{content:"\0025cb  "}ul.lst-kix_7eyu3rfxxwjr-0{list-style-type:none}ul.lst-kix_7eyu3rfxxwjr-1{list-style-type:none}.lst-kix_7g4otyu426l0-3>li:before{content:"\0025cf  "}.lst-kix_7g4otyu426l0-5>li:before{content:"\0025a0  "}ul.lst-kix_7eyu3rfxxwjr-2{list-style-type:none}ul.lst-kix_7eyu3rfxxwjr-3{list-style-type:none}.lst-kix_7eyu3rfxxwjr-6>li:before{content:"\0025cf  "}ul.lst-kix_7eyu3rfxxwjr-4{list-style-type:none}ul.lst-kix_7eyu3rfxxwjr-5{list-style-type:none}.lst-kix_7eyu3rfxxwjr-7>li:before{content:"\0025cb  "}ul.lst-kix_7eyu3rfxxwjr-6{list-style-type:none}.lst-kix_7eyu3rfxxwjr-0>li:before{content:"\0025cf  "}.lst-kix_7eyu3rfxxwjr-1>li:before{content:"\0025cb  "}.lst-kix_7eyu3rfxxwjr-4>li:before{content:"\0025cb  "}.lst-kix_7eyu3rfxxwjr-2>li:before{content:"\0025a0  "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_7eyu3rfxxwjr-3>li:before{content:"\0025cf  "}.lst-kix_7g4otyu426l0-8>li:before{content:"\0025a0  "}ul.lst-kix_7g4otyu426l0-1{list-style-type:none}ul.lst-kix_7g4otyu426l0-0{list-style-type:none}ul.lst-kix_7g4otyu426l0-8{list-style-type:none}ul.lst-kix_7g4otyu426l0-7{list-style-type:none}ul.lst-kix_7g4otyu426l0-6{list-style-type:none}ul.lst-kix_7g4otyu426l0-5{list-style-type:none}ul.lst-kix_7g4otyu426l0-4{list-style-type:none}ul.lst-kix_7g4otyu426l0-3{list-style-type:none}ul.lst-kix_7g4otyu426l0-2{list-style-type:none}ol{margin:0;padding:0}table td,table th{padding:0}.c0{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#dee2e6;border-top-width:1pt;border-right-width:1pt;border-left-color:#dee2e6;vertical-align:top;border-right-color:#dee2e6;border-left-width:1pt;border-top-style:solid;background-color:#fdfdfe;border-left-style:solid;border-bottom-width:1pt;width:156pt;border-top-color:#dee2e6;border-bottom-style:solid}.c1{color:#373a3c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11.5pt;font-family:"Roboto";font-style:normal}.c10{color:#373a3c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11.5pt;font-family:"Roboto";font-style:italic}.c15{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c14{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c12{color:#373a3c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:17.5pt;font-family:"Roboto";font-style:normal}.c6{color:#373a3c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:17pt;font-family:"Roboto";font-style:normal}.c9{padding-top:0pt;padding-bottom:4pt;line-height:1.2;orphans:2;widows:2;text-align:left}.c2{padding-top:0pt;padding-bottom:12pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c3{border-spacing:0;border-collapse:collapse;margin-right:auto}.c13{font-size:11.5pt;font-family:"Roboto";color:#373a3c;font-weight:400}.c8{margin-left:36pt;padding-left:0pt}.c11{padding:0;margin:0}.c7{max-width:468pt;padding:72pt 72pt 72pt 72pt}.c4{height:56.5pt}.c5{background-color:#ffffff}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c5 c7"><h2 class="c5 c9" id="h.wpg6vlws4vey"><span class="c6">Assignment-1</span></h2><p class="c2 c5"><span class="c1">1. How to query the factorial of 6 recursively</span></p><p class="c2 c5"><span class="c1">We reduce the problem into smaller problems of the same type to define the factorial n! recursively. For this the following definition can be used:</span></p><ul class="c11 lst-kix_7eyu3rfxxwjr-0 start"><li class="c2 c8 li-bullet-0"><span class="c1">0! = 1 for step = 0</span></li><li class="c2 c8 li-bullet-0"><span class="c1">(n+1)! = n! * (step+1) for step &gt; 0</span></li></ul><p class="c2 c5"><span class="c1">With this simple definition you can calculate the factorial of every number. In this exercise, n! is represented by factorial.</span></p><p class="c2 c5"><span class="c1">You are going to leverage the definition above with the help of a recursive CTE.</span></p><ul class="c11 lst-kix_7g4otyu426l0-0 start"><li class="c2 c8 li-bullet-0"><span class="c1">Initialize the fields factorial and step to 1.</span></li><li class="c2 c8 li-bullet-0"><span class="c1">Calculate the recursive part with factorial * (step + 1).</span></li><li class="c2 c8 li-bullet-0"><span class="c1">Stop the recursion process when the current iteration value is smaller than the target factorial number.</span></li></ul><h2 class="c9 c5" id="h.mb3j2epawses"><span class="c12">2. Cancellation rates,</span></h2><p class="c2 c5"><span class="c1">From the following table of user IDs, actions, and dates, write a query to return the publication and cancellation rate for each user.</span></p><p class="c2 c5"><span class="c1">users</span></p><a id="t.c85abc75e0f71ef20be2afe1adb495c33c68b744"></a><a id="t.0"></a><table class="c3"><tbody><tr class="c4"><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">User_id</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">Action</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">date</span></p></td></tr><tr class="c4"><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">1</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">Start</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">1-1-20</span></p></td></tr><tr class="c4"><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">1</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">Cancel</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">1-2-20</span></p></td></tr><tr class="c4"><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">2</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">Start</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">1-3-20</span></p></td></tr><tr class="c4"><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">2</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">Publish</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">1-4-20</span></p></td></tr><tr class="c4"><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">3</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">Start</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">1-5-20</span></p></td></tr><tr class="c4"><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">3</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">Cancel</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">1-6-20</span></p></td></tr><tr class="c4"><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">1</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">Start</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">1-7-20</span></p></td></tr><tr class="c4"><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">1</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">publish</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">1-8-20</span></p></td></tr></tbody></table><p class="c2 c5"><span class="c1">&nbsp;</span></p><p class="c2 c5"><span class="c1">&nbsp;</span></p><p class="c2 c5"><span class="c1">Desired_output</span></p><a id="t.76bd57f0dcf59c6a6c0d943002eb4d2448515457"></a><a id="t.1"></a><table class="c3"><tbody><tr class="c4"><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">User_id</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">Publish_rate</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">Cancel_rate</span></p></td></tr><tr class="c4"><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">1</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">0.5</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">0.5</span></p></td></tr><tr class="c4"><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">2</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">1.0</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">0.0</span></p></td></tr><tr class="c4"><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">3</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">0.0</span></p></td><td class="c0" colspan="1" rowspan="1"><p class="c2"><span class="c1">1.0</span></p></td></tr></tbody></table><p class="c2 c5"><span class="c1">&nbsp;</span></p><p class="c2 c5"><span class="c1">a. &nbsp; &nbsp;Create above table (users) with &ldquo;with&rdquo; clause,</span></p><p class="c2 c5"><span class="c1">&nbsp;</span></p><p class="c2 c5"><span class="c10">b. &nbsp; &nbsp;Retrieve count of starts, cancels, and publishes for each user,</span></p><p class="c2 c5"><span class="c10">&nbsp;</span></p><p class="c2 c5"><span class="c13">c. &nbsp; &nbsp;</span><span class="c10">Calculate publication, cancelation rate for each user by dividing by number of starts, casting as float by multiplying by 1.0</span></p><p class="c14"><span class="c15"></span></p></body></html>